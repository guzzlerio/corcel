language: go
sudo: false

go:
   - 1.5

env:
   global:
      - BUILD_GOARCH=amd64

before_install:
   - go get github.com/mitchellh/gox
   - go get github.com/tcnksm/ghr

after_success:
   - gox -os="linux" -output "dist/{{.OS}}_{{.Arch}}_{{.Dir}}"
   - bash ./ci/deploy-to-github.sh

install:
   - go get -t -v ./...

script:
   - go build
   - go test -v ./...
